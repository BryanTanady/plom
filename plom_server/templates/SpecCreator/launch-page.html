<!--
    SPDX-License-Identifier: AGPL-3.0-or-later
    Copyright (C) 2022-2023 Edith Coates
    Copyright (C) 2023-2024 Colin B. Macdonald
-->
{% extends "base/base.html" %}
{% block title %}
    Create assessment specification
{% endblock title %}
{% block page_heading %}
    Create assessment specification
{% endblock page_heading %}
{% block main_content %}
    <div class="d-grid">
        <div>
            <a class="btn btn-primary mb-3" href="{% url 'prep_landing' %}">Return to assessment preparation page</a>
        </div>
        {% if is_there_a_spec %}
            <div class="alert alert-primary mb-3" role="alert">
                There is a spec in the database: <a href="{% url 'spec_summary' %}">view</a>
            </div>
        {% endif %}
        <div class="card">
            <div class="card-body">
                <form enctype="multipart/form-data"
                      hx-post="{% url 'creator_launch' %}"
                      hx-include="[name='spec']"
                      hx-target="#saving-status">
                    {% csrf_token %}
                    <p>
                        You can use the
                        <a class="btn btn-primary" href="{% url 'template_spec_builder' %}">Template
                        Spec Builder</a>
                        which helps you describe the structure of your assessment
                        in <a href="https://toml.io/en/" target="_blank">.toml format</a>.
                    </p>
                    <p>
                        Or you can upload a file:
                        <div class="input-group">
                            <input class="form-control"
                                   type="file"
                                   accept=".toml"
                                   name="toml_file"
                                   id="toml_file" />
                            <button type="submit"
                                    class="btn btn-primary"
                                    name="which_action"
                                    value="upload_file">Upload</button>
                        </div>
                    </p>
                    <p>Or simply paste in your specification into the box below.</p>
                    <label for="spec-toml-input" class="form-label">Test specification</label>
                    <textarea class="form-control mb-3"
                              id="spec-toml-input"
                              name="spec"
                              rows="12"
                              spellcheck="false">{% if is_there_a_spec %}{{ spec_toml }}{% endif %}</textarea>
                    <button type="submit" class="btn btn-primary">Submit</button>
                    <!-- <button type="submit"
         class="btn btn-primary"
         name="which_action"
         value="submit">Submit</button> -->
                    <button type="submit"
                            class="btn btn-secondary"
                            name="which_action"
                            value="validate">Validate</button>
                    <div class="mt-3" id="saving-status"></div>
                </form>
            </div>
        </div>
    </div>
{% endblock main_content %}
