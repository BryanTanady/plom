<!--
    SPDX-License-Identifier: AGPL-3.0-or-later
    Copyright (C) 2023 Divy Patel
    Copyright (C) 2023 Colin B. Macdonald
    Copyright (C) 2023 Andrew Rechnitzer
-->
{% extends "base/base.html" %}
{% load static %}
{% load humanize %}
{% block title %}
    Marking task info
{% endblock title %}
{% block page_heading %}
    Marking task info
{% endblock page_heading %}
{% block main_content %}
    <div class="container p-2 border rounded mx-0">
        <div class="row m-2">
            <div class="col">
                <p>Paper: {{ paper_number }}</p>
                <p>Question: {{ question }}</p>
                <p>Version: {{ version }}</p>
                <p>Status: {{ status }}</p>
                {% if status == "Complete" %}
                    <p>Score: {{ score }}</p>
                    <p>Edition: {{ edition }}</p>
                    <p>User: {{ username }}</p>
                    <p>Last update: {{ last_update|naturaltime }}</p>
                    <p>Marking time: {{ marking_time }}s</p>
                {% elif status == "Out" %}
                    <p>User: {{ username }}</p>
                {% elif status == "To Do" %}
                {% else %}
                {% endif %}
                <p>
                    <button hx-get="{% url 'progress_original_img_wrap' paper_number question %}"
                            hx-target="#imageHere"
                            hx-replace="innerHTML"
                            class="btn btn-outline-info">show original</button>
                    {% if status == "Complete" %}
                        <button hx-get="{% url 'progress_annotation_img_wrap' paper_number question %}"
                                hx-target="#imageHere"
                                hx-replace="innerHTML"
                                class="btn btn-outline-success">show annotation</button>
                    {% endif %}
                </p>
                <p>
                    <a class="btn btn-primary"
                       href="{% url 'progress_marking_task_filter' %}?question={{ question }}&version={{ version }}">browse marking</a>
                </p>
            </div>
            <div class="col-auto">
                <div id="imageHere"></div>
            </div>
        </div>
        {% if status == "Complete" %}
            <div class="row m-2">
                <h3>Rubrics used in latest annotation</h3>
                <table class="table table-striped table-bordered sortable table-sm table-responsive w-auto">
                    <thead>
                        <tr>
                            <th>Rubric-key</th>
                            <th>Question</th>
                            <th>Kind</th>
                            <th>Display Delta</th>
                            <th>Text</th>
                            <th>More details</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for rubric in rubrics %}
                            <tr>
                                <td>{{ rubric.key }}</td>
                                <td>{{ rubric.question }}</td>
                                <td>{{ rubric.kind }}</td>
                                <td>{{ rubric.display_delta }}</td>
                                <td>{{ rubric.text }}</td>
                                <td class="text-center">
                                    <a class="btn btn-outline-primary"
                                       href="{% url 'rubric_item' rubric.key %}">info</a>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% endif %}
        </div>
    {% endblock main_content %}
