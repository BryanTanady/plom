%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% SPDX-License-Identifier: AGPL-3.0-or-later
%% Copyright (C) 2023 Andrew Rechnitzer
%% Copyright (C) 2023 Colin B. Macdonald
%% Copyright (C) 2024 Forest Kobayashi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass{memoir}
\usepackage[draft]{graphicx}
\usepackage[letterpaper,left=29mm,right=29mm,top=10mm,bottom=4mm]{geometry}
\usepackage{booktabs}
\usepackage{color}
\usepackage{amsmath}
\usepackage{tikz}
\usetikzlibrary{calc}
\usepackage{enumitem}
\usepackage{mdframed}

\usepackage[breakable, skins]{tcolorbox}
\newtcolorbox{pagebox}{
  enhanced,
  colback=white,
  colframe=white,
  overlay={
    \def\cornerlen{.5cm}
    \def\cornerwidth{2pt}

    % extra buffer
    \def\exbuff{0cm}

    \coordinate (nwe) at ($(frame.north west) + (\cornerlen, 0cm)$);
    \coordinate (nws) at ($(frame.north west) + (0, -\cornerlen)$);

    \coordinate (swe) at ($(frame.south west) + (\cornerlen, 0cm)$);
    \coordinate (swn) at ($(frame.south west) + (0, \cornerlen)$);

    \coordinate (new) at ($(frame.north east) + (-\cornerlen, 0cm)$);
    \coordinate (nes) at ($(frame.north east) + (0, -\cornerlen)$);

    \coordinate (sew) at ($(frame.south east) + (-\cornerlen, 0cm)$);
    \coordinate (sen) at ($(frame.south east) + (0, \cornerlen)$);

    \draw[line width=\cornerwidth/2, gray!50!white, densely dotted] (frame.north west) rectangle (frame.south east);

    \draw[line width=\cornerwidth] (nwe) -- (frame.north west) -- (nws);
    \draw[line width=\cornerwidth] (new) -- (frame.north east) -- (nes);
    \draw[line width=\cornerwidth] (swn) -- (frame.south west) -- (swe);
    \draw[line width=\cornerwidth] (sew) -- (frame.south east) -- (sen);
  }
}



\setlength{\parindent}{0em}

%%%%%%%%%%%%%

\pagestyle{empty}

\newcommand{\bundleseparatorbundleseparator}[4]{
  \begin{tikzpicture}[remember picture, overlay]
    \node[anchor=north east, xshift=-8mm, yshift=-8mm, line width=0.25pt, draw=black, inner sep=1pt] (qrne) at (current page.north east) {\includegraphics[angle= 90, origin=c, height=15mm]{#1}};
    \node[anchor=north west, xshift= 8mm, yshift=-8mm, line width=0.25pt, draw=black, inner sep=1pt] (qrnw) at (current page.north west) {\includegraphics[angle=180, origin=c, height=15mm]{#2}};
    \node[anchor=south west, xshift= 8mm, yshift= 8mm, line width=0.25pt, draw=black, inner sep=1pt] (qrsw) at (current page.south west) {\includegraphics[angle=-90, origin=c, height=15mm]{#3}};
    \node[anchor=south east, xshift=-8mm, yshift= 8mm, line width=0.25pt, draw=black, inner sep=1pt] (qrse) at (current page.south east) {\includegraphics[angle=  0, origin=c, height=15mm]{#4}};

    \pgfmathsetmacro{\dx}{1.5}
    \pgfmathsetmacro{\dya}{1}
    \pgfmathsetmacro{\dyb}{\dya + .25}

  \end{tikzpicture}
}



\begin{document}
% Adding a space character like this (or something) seems to be
% necessar to get the vertical positioning right.
\,

\vspace{6cm}


\begin{center}
  \begin{minipage}{.7\linewidth}
    \begin{pagebox}
      \centering

      {\HUGE \bfseries \texttt{Plom} Bundle Separator}
      \vspace{1cm}

      \newcommand{\infobox}[1]{\raisebox{-1.1em}{\framebox(#1,32){}}}
      \begin{tabular}{cccccc}
        \Large Course && \Large Section && \Large Year \\
        \infobox{50} && \infobox{50} && \infobox{50}
      \end{tabular}

      \vspace{1cm}

      \newcommand{\newinfobox}[1]{\raisebox{-.7em}{\framebox(#1,32){}}}
      \newenvironment{notebox}{\begin{minipage}{.7\linewidth}}{\end{minipage}}
      \setlength{\arrayrulewidth}{1pt}
      \begin{tabular}{cc}
        \Huge Bundle Prefix
        & \Huge Bundle Suffix \\[.5em]
        \newinfobox{150} & \newinfobox{100} \\[.5em]
        (E.g.\ \texttt{BUCH-A101})
        & (E.g.\ \texttt{batch-1})
      \end{tabular}

      \vspace{1cm}

      \begin{mdframed}
        \Large Notes: \hfill

        \vspace{3cm}
      \end{mdframed}

    \end{pagebox}
  \end{minipage}
\end{center}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bundleseparatorbundleseparator{qr_crn_1}{qr_crn_2}{qr_crn_3}{qr_crn_4}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage

\,

\vfill
\begin{center}
  {\HUGE \bfseries \texttt{Plom} Bundle Separator (Back)}
\end{center}
\vfill

% Ensure QR codes appear on back as well
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bundleseparatorbundleseparator{qr_crn_5}{qr_crn_6}{qr_crn_7}{qr_crn_8}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}
